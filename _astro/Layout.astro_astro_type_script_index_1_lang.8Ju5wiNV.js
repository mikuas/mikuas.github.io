import{B,b as v,c as T}from"./constants.BP25BUWi.js";import{s as I}from"./config.7OfNXQak.js";import{p as S,u as H}from"./url-utils.DB-UjCHS.js";import"./zh_TW.Da9O402A.js";const E=!!document.getElementById("banner-wrapper");function L(t,n){document.addEventListener("click",e=>{let o=document.getElementById(t),s=e.target;if(s instanceof Node){for(let i of n){let c=document.getElementById(i);if(c==s||c?.contains(s))return}o.classList.add("float-panel-closed")}})}L("display-setting",["display-setting","display-settings-switch"]);L("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]);L("search-panel",["search-panel","search-bar","search-switch"]);function A(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(n=>{if(!n.parentNode)return;const e=document.createElement("div");e.className="katex-display-container",n.parentNode.insertBefore(e,n),e.appendChild(n),e.style.cssText=`
			overflow-x: auto;
			scrollbar-width: thin;
			scrollbar-color: rgba(0,0,0,0.3) transparent;
		`;const o=document.createElement("style");o.textContent=`
			.katex-display-container::-webkit-scrollbar {
				height: 6px;
			}
			.katex-display-container::-webkit-scrollbar-track {
				background: transparent;
			}
			.katex-display-container::-webkit-scrollbar-thumb {
				background: rgba(0,0,0,0.3);
				border-radius: 3px;
			}
			.katex-display-container::-webkit-scrollbar-thumb:hover {
				background: rgba(0,0,0,0.5);
			}
		`,document.head.querySelector("style[data-katex-scrollbar]")||(o.setAttribute("data-katex-scrollbar","true"),document.head.appendChild(o)),n.setAttribute("data-scrollbar-initialized","true")})}function k(){requestAnimationFrame(()=>{const t=document.getElementById("banner");t&&t.classList.remove("opacity-0","scale-105");const n=document.querySelector('.block.lg\\:hidden[alt="Mobile banner image of the blog"]');n&&!document.getElementById("banner-carousel")&&(n.classList.remove("opacity-0","scale-105"),n.classList.add("opacity-100")),document.getElementById("banner-carousel")&&C()})}function C(){const t=document.querySelectorAll(".carousel-item"),n=window.innerWidth<1024,e=Array.from(t).filter(o=>n?o.querySelector(".block.lg\\:hidden"):o.querySelector(".hidden.lg\\:block"));if(e.length>1,e.length>1&&I.banner.carousel?.enable){let o=function(a){const m=e[i];m.classList.remove("opacity-100","scale-100"),m.classList.add("opacity-0","scale-110"),i=a;const p=e[i];p.classList.add("opacity-100","scale-100"),p.classList.remove("opacity-0","scale-110")},s=function(){clearInterval(r),r=setInterval(()=>{if(!l){const a=(i+1)%e.length;o(a)}},c*1e3)},i=0;const c=I.banner.carousel?.interval;let r,l=!1,d=0,f=0,h=!1;const u=document.getElementById("banner-carousel");t.forEach(a=>{a.classList.add("opacity-0","scale-110"),a.classList.remove("opacity-100","scale-100")}),e.length>0&&(e[0].classList.add("opacity-100","scale-100"),e[0].classList.remove("opacity-0","scale-110")),u&&"ontouchstart"in window&&(u.addEventListener("touchstart",a=>{d=a.touches[0].clientX,f=a.touches[0].clientY,h=!1,l=!0,clearInterval(r)},{passive:!0}),u.addEventListener("touchmove",a=>{if(!d||!f)return;const m=Math.abs(a.touches[0].clientX-d),p=Math.abs(a.touches[0].clientY-f);m>p&&m>30&&(h=!0,a.preventDefault())},{passive:!1}),u.addEventListener("touchend",a=>{if(!d||!f||!h){l=!1,s();return}const m=a.changedTouches[0].clientX,p=d-m;if(Math.abs(p)>50)if(p>0){const b=(i+1)%e.length;o(b)}else{const b=(i-1+e.length)%e.length;o(b)}d=0,f=0,h=!1,l=!1,s()},{passive:!0})),u&&(u.addEventListener("mouseenter",()=>{l=!0,clearInterval(r)}),u.addEventListener("mouseleave",()=>{l=!1,s()})),s()}}const x=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),E){const t=document.getElementById("navbar-wrapper");if(t&&document.body.classList.contains("lg:is-home")){const n=window.innerHeight*(v/100)-88;document.documentElement.scrollTop>=n&&t.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(A(),document.getElementById("toc-wrapper")!==null){const o=document.querySelector("table-of-contents");o&&typeof o.init=="function"&&setTimeout(()=>{o.init()},100),typeof window.mobileTOCInit=="function"&&setTimeout(()=>{window.mobileTOCInit()},100)}setTimeout(()=>{typeof window.translate<"u"&&window.translate.execute()},100);const e=document.getElementById("navbar");e&&e.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",t=>{const n=document.querySelector("body"),e=S(t.to.url,H("/"));e?n.classList.add("lg:is-home"):n.classList.remove("lg:is-home");const o=document.querySelector(".banner-text-overlay");o&&(e?o.classList.remove("hidden"):o.classList.add("hidden"));const s=document.getElementById("navbar");s&&(s.setAttribute("data-is-home",e.toString()),s.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const i=document.getElementById("banner-wrapper"),c=document.querySelector(".absolute.w-full.z-30");i&&c&&(e?(setTimeout(()=>{i.classList.remove("mobile-hide-banner")},100),setTimeout(()=>{c.classList.remove("mobile-main-no-banner")},150)):(i.classList.add("mobile-hide-banner"),setTimeout(()=>{c.classList.add("mobile-main-no-banner")},100)));const r=document.getElementById("page-height-extend");r&&r.classList.remove("hidden");let l=document.getElementById("toc-wrapper");l&&l.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const t=document.getElementById("page-height-extend");t&&t.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"}),setTimeout(()=>{if(document.getElementById("tcomment")){const n=new CustomEvent("mizuki:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(n),console.log("Layout: 触发 mizuki:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",t=>{setTimeout(()=>{const n=document.getElementById("page-height-extend");n&&n.classList.add("hidden");const e=document.getElementById("toc-wrapper");e&&e.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?x():document.addEventListener("swup:enable",x);let w=document.getElementById("back-to-top-btn"),g=document.getElementById("toc-wrapper"),y=document.getElementById("navbar-wrapper");function q(t,n){let e;return function(){const o=arguments,s=this;e||(t.apply(s,o),e=!0,setTimeout(()=>e=!1,n))}}function M(){const t=document.documentElement.scrollTop,n=window.innerHeight*(v/100);requestAnimationFrame(()=>{if(w&&(t>n?w.classList.remove("hide"):w.classList.add("hide")),E&&g&&(t>n?g.classList.remove("toc-hide"):g.classList.add("toc-hide")),E&&y){const o=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?T:v,s=window.innerHeight*(o/100)-88;t>=s?y.classList.add("navbar-hidden"):y.classList.remove("navbar-hidden")}})}window.onscroll=q(M,16);window.onresize=()=>{let t=Math.floor(window.innerHeight*(B/100));t=t-t%4,document.documentElement.style.setProperty("--banner-height-extend",`${t}px`)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{k()}):k();
